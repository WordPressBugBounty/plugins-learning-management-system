!function(i,a){var r={init:function(){this.bindUIActions()},bindUIActions:function(){i("#masteriyoGroupCoursesEnrollBtn .masteriyo-group-course__buy-now-button").on("click",this.openGroupCoursesModal.bind(this)),i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__exit-popup").on("click",this.closeGroupCoursesModal.bind(this)),i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--sync-button").on("click",this.fetchGroups.bind(this)),i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--footer_checkout-button").on("click",this.addToCart.bind(this)),i(document).on("change","#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--list-checkbox",this.toggleAddToCartButton),i("#masteriyoGroupCoursesEnrollModal").on("change click",".masteriyo-group-course__lists--list-checkbox, .masteriyo-group-course__buy-now-button, .masteriyo-group-course__lists--sync-button, .masteriyo-group-course__exit-popup",function(){i(".masteriyo-error-message").remove()})},toggleAddToCartButton:function(){var o=i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--footer_checkout-button"),s=0<i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--list-checkbox:checked").length;o.attr("disabled",!s),o.toggleClass("masteriyo-group-course__lists--footer_checkout-button--disabled",!s)},addToCart:function(){var o,s=i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--list-checkbox:checked").map(function(){return this.value}).get(),e=a.course_id,e=i(`#course-${e} .masteriyo-single-course--btn, .masteriyo-enroll-btn`);0===s.length?e.addClass("masteriyo-group-course__lists--footer_checkout-button--disabled"):(e.removeClass("masteriyo-group-course__lists--footer_checkout-button--disabled"),e=a.add_to_cart_url,o=i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--list-checkbox:checked").closest("li").map(function(){return parseInt(i(this).data("emails-length"),10)||0}).get().reduce(function(o,s){return o+s},0),a.remaining_enrollment_counts&&a.remaining_enrollment_counts-o<0?(o=wp.i18n.sprintf(wp.i18n.__("Only %1$d spots are available out of %2$d. Please reduce your selection.","learning-management-system"),a.remaining_enrollment_counts,a.enrollment_limits),i(".masteriyo-error-message").remove(),i(".masteriyo-group-course__lists--list").first().after(`<div class="masteriyo-error-message">${o}</div>`)):e&&((o=new URL(e,window.location.origin)).searchParams.set("group_ids",s.join(",")),window.location.href=o.toString()))},fetchGroups:function(){var s=i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--sync-button"),e=(s.text(s.data("fetching-text")).attr("disabled",!0),i("#masteriyoGroupCoursesEnrollModal .masteriyo-groups-loading-text"));e.removeClass("masteriyo-hidden"),i.ajax({url:a.restUrl,type:"GET",dataType:"json",data:{per_page:20,status:"publish"},beforeSend:function(o){o.setRequestHeader("X-WP-Nonce",a.wp_rest_nonce)},success:function(o){s.text(s.data("fetch-text")).attr("disabled",!1),e.addClass("masteriyo-hidden"),r.renderGroupsList(o.data||[])},error:function(o){s.text(s.data("fetch-text")).attr("disabled",!1),e.addClass("masteriyo-hidden"),i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists").hide()}})},renderGroupsList:function(o){var e,s=i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists"),r=i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--list"),t=(r.html(""),i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__empty-state"));0===o.length?(t.show(),s.hide()):(t.hide(),s.show(),e=parseInt(a.max_group_size),o.forEach(function(o){var s=!!(e&&o.emails.length>parseInt(e)),s=i(`
								<li class="masteriyo-group-course__lists--list-item ${s?"masteriyo-group-course__lists--list-item_disabled":""}" data-emails-length="${o.emails.length}">
									<input type="checkbox" class="masteriyo-group-course__lists--list-checkbox" name="group_ids[]" value="${o.id}" id="masteriyo-group-course-option-${o.id}" ${s?"disabled":""}>
									<label class="masteriyo-group-course__lists--list-item_label ${s?"masteriyo-group-course__lists--list-item_label_disabled":""}" for="masteriyo-group-course-option-${o.id}">
									${o.title}
									</label>
					
									<div class="masteriyo-group-course__lists--list-item_members" title="${a.members_text}">
										<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
											<path fill="#7A7A7A" d="M21 20.4c-.6 0-1-.4-1-1v-1.6c0-1-.7-1.9-1.7-2.2-.5-.1-.9-.7-.7-1.2.1-.5.7-.9 1.2-.7 1.9.5 3.2 2.2 3.2 4.1v1.6c0 .5-.4 1-1 1Zm-4.9 0c-.6 0-1-.4-1-1v-1.6c0-1.3-1-2.3-2.3-2.3H6.3c-1.3 0-2.3 1-2.3 2.3v1.6c0 .6-.4 1-1 1s-1-.4-1-1v-1.6c0-2.4 1.9-4.3 4.3-4.3h6.5c2.4 0 4.3 1.9 4.3 4.3v1.6c0 .5-.5 1-1 1Zm-6.6-8.2c-2.4 0-4.3-1.9-4.3-4.3s1.9-4.3 4.3-4.3 4.3 1.9 4.3 4.3-1.9 4.3-4.3 4.3Zm0-6.6c-1.3 0-2.3 1-2.3 2.3 0 1.3 1 2.3 2.3 2.3 1.3 0 2.3-1 2.3-2.3 0-1.2-1-2.3-2.3-2.3Zm5.8 6.5c-.4 0-.9-.3-1-.8-.1-.5.2-1.1.7-1.2.8-.2 1.4-.8 1.6-1.6.4-1.2-.4-2.5-1.6-2.8-.5-.1-.9-.7-.7-1.2.2-.5.7-.9 1.2-.7 2.3.6 3.7 2.9 3.1 5.2-.4 1.5-1.6 2.7-3.1 3.1h-.2Z" />
										</svg>
										${o.emails.length}
									</div>
								</li>
							`);r.append(s)}))},openGroupCoursesModal:function(o){o.preventDefault(),i("#masteriyoGroupCoursesEnrollModal").removeClass("masteriyo-hidden");o=i("#masteriyoGroupCoursesEnrollModal .masteriyo-group-course__lists--list");parseInt(a.max_group_size)?i("#masteriyoGroupCoursesEnrollModal .masteriyo-info-msg").show().html(`<span>${a.max_group_size_msg}</span>`):i("#masteriyoGroupCoursesEnrollModal .masteriyo-info-msg").hide().html(""),0===o.find(".masteriyo-group-courses-item").length&&this.fetchGroups()},closeGroupCoursesModal:function(){i("#masteriyoGroupCoursesEnrollModal").addClass("masteriyo-hidden")}};a&&r.init()}(jQuery,window.MASTERIYO_GROUP_COURSES_DATA);