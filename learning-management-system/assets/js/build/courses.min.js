!function(c,a){var e={openFiltersSidebar:function(){var e,t=c(".masteriyo-courses-filters");t.length?(e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t.addClass("masteriyo-expanded"),("fixed"===c("#wpadminbar").css("position")||e<c("#wpadminbar").height()-20)&&t.addClass("masteriyo-add-admin-bar-margin"),"undefined"!=typeof masteriyo_helper&&masteriyo_helper.lockScrolling()):console.warn(".masteriyo-courses-filters element not found.")},closeFiltersSidebar:function(){var e=c(".masteriyo-courses-filters");e.length&&(e.removeClass("masteriyo-expanded"),e.removeClass("masteriyo-add-admin-bar-margin"),"undefined"!=typeof masteriyo_helper)&&masteriyo_helper.unlockScrolling()},isFiltersSidebarOpen:function(){var e=c(".masteriyo-courses-filters");return e.length&&e.hasClass("masteriyo-expanded")},toggleFiltersSidebar:function(){this.isFiltersSidebarOpen()||this.openFiltersSidebar()}},n={currentViewMode:function(e){for(var t=e+"=",s=document.cookie.split(";"),o=0;o<s.length;o++){for(var r=s[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}("MasteriyoCoursesViewMode"),viewModeItems:null,init:function(){this.viewModeItems=c(".masteriyo-courses-view-mode-item"),this.bindUIActions(),"grid-view"!==this.currentViewMode&&"list-view"!==this.currentViewMode||this.setViewMode(this.currentViewMode),c(document).ready(function(){n.init_password_projected_form_handler(),n.init_course_filters()}),c(document).ready(function(){c(".masteriyo-course-archive--aside").each(function(){0===c(this).children().length&&c(this).remove()})})},bindUIActions:function(){this.viewModeItems.on("click",".view-mode",function(){var e=c(this).data("mode");n.setViewMode(e),n.viewModeItems.removeClass("active"),c(this).closest(".masteriyo-courses-view-mode-item").addClass("active")})},setViewMode:function(e){var t="MasteriyoCoursesViewMode",s=e,o=365,r="",o=(o&&((i=new Date).setTime(i.getTime()+864e5*o),r="; expires="+i.toGMTString()),document.cookie=t+"="+s+r+"; path=/",c(".masteriyo-courses-view-mode-section .masteriyo-courses-view-mode-item-lists").data("courses-class")||"masteriyo-course"),i=c(".masteriyo-course-list-display-section ."+o);i.removeClass("list-view"),i.removeClass("grid-view"),n.viewModeItems.removeClass("active"),this.viewModeItems.find('.view-mode[data-mode="'+e+'"]').parent().addClass("active"),i.addClass(e),this.currentViewMode=e},init_password_projected_form_handler:function(){var e=c(".masteriyo-password-protected"),t=0,s=c("#masteriyoCoursePasswordProtectedModal .masteriyo-submit"),o=s.text(),r=o;function i(e){e.preventDefault(),r=s.data("loading-text"),s.text(r),s.prop("disabled",!0);e=c("#masteriyoPostPassword").val();e?c.ajax({type:"POST",dataType:"json",data:{action:"masteriyo_course_password_protection",nonce:a.password_protected_nonce,password:e,course_id:t},url:a.ajaxURL,success:function(e){r=o,s.text(r),s.prop("disabled",!1),e.success?(c("#masteriyoPostPassword").val(""),c("#passwordError").text(""),c("#masteriyoCoursePasswordProtectedModal").addClass("masteriyo-hidden"),e.data&&e.data.start_url&&window.open(e.data.start_url)):e.data&&e.data.message&&c("#passwordError").text(e.data.message).show()},error:function(e){r=o,s.text(r),s.prop("disabled",!1);var t="An error occurred";e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.message&&(t=e.responseJSON.data.message),c("#passwordError").text(t).show()}}):a.labels&&a.labels.password_not_empty&&(c("#passwordError").text(a.labels.password_not_empty).show(),r=o,s.text(r),s.prop("disabled",!1))}e.on("click",function(e){e.preventDefault(),t=c(this).attr("href").split("=")[1],c("#masteriyoCoursePasswordProtectedModal").removeClass("masteriyo-hidden")}),c("#masteriyoCoursePasswordProtectedModal .masteriyo-cancel").on("click",function(e){e.preventDefault(),c("#masteriyoCoursePasswordProtectedModal").addClass("masteriyo-hidden")}),c("#masteriyoCoursePasswordProtectedModal form").on("submit",function(e){e.preventDefault()}),c("#masteriyoCoursePasswordProtectedModal .masteriyo-submit").on("click",function(e){i(e)}),c("#masteriyoCoursePasswordProtectedModal form").keypress(function(e){13==e.which&&i(e)})},init_course_filters:function(){c(document.body).on("click",".masteriyo-toggle-course-filters-sidebar",function(){e.toggleFiltersSidebar()}),c(document.body).on("click",".masteriyo-close-filters-sidebar, .masteriyo-course-filter-sidebar-overlay",function(){e.closeFiltersSidebar()}),c(window).on("resize",function(){c(this).height()<=768&&e.closeFiltersSidebar()}),c(document.body).on("click",".masteriyo-see-more-categories",function(e){e.preventDefault(),c(this).addClass("masteriyo-hidden"),c(".masteriyo-overflowed-category").removeClass("masteriyo-hidden"),c(".masteriyo-see-less-categories").removeClass("masteriyo-hidden")}),c(document.body).on("click",".masteriyo-see-less-categories",function(e){e.preventDefault(),c(this).addClass("masteriyo-hidden"),c(".masteriyo-overflowed-category").addClass("masteriyo-hidden"),c(".masteriyo-see-more-categories").removeClass("masteriyo-hidden")})}};var r={currentPage:0,refreshCallsCount:0,refreshCourses:function(){r.refreshCallsCount++;var s={action:"masteriyo_course_filter_and_sorting"};c(".masteriyo-courses-filters").find("input,select,textarea").each(function(){var e=c(this).prop("type"),t=c(this).prop("name");"checkbox"===e?(t=t.trim().replace(/\[\]$/,""),Array.isArray(s[t])||(s[t]=[]),c(this).is(":checked")&&s[t].push(c(this).val())):"radio"===e&&!c(this).is(":checked")||(s[t]=c(this).val())}),s._wpnonce=c('[name="masteriyo_course_filter_and_sorting_nonce"]').val(),s.page=r.currentPage,s.search=c(".search-field.masteriyo-input").val(),s.orderby=c("select.masteriyo-courses-order-by").val(),s.order=c("input.masteriyo-courses-sorting-order").val(),s.layout=c(".masteriyo-course-list-display-section").data("layout"),c.ajax({type:"POST",url:masteriyo_data.ajaxURL,dataType:"json",data:s,beforeSend:function(e){c(".masteriyo-courses-wrapper").addClass("masteriyo-applying-filter").block({message:'<span class="spinner" style="visibility:visible"></span>',css:{border:"",width:"0%"},overlayCSS:{background:"#fff",opacity:.6}})},success:function(e,t,s){e=e.data;r.refreshCallsCount<=1&&e&&e.fragments&&(c.each(e.fragments,function(e,t){o.fragments&&o.fragments[e]===t||c(e).replaceWith(t),c(e).unblock()}),o.fragments=e.fragments),c(".masteriyo-group-course__group-button").addClass("masteriyo-hidden"),n.init()},error:function(e,t,s){},complete:function(e,t){r.refreshCallsCount<=1&&c(".masteriyo-courses-wrapper").removeClass("masteriyo-applying-filter").unblock(),r.refreshCallsCount--}})}},o={init:function(){c(document).ready(function(){o.init_course_search(),o.init_course_filters(),o.init_course_sorting(),o.toggleFiltersSidebar(),o.init_price_slider(),o.toggle_masteriyo_instructor(),o.init_course_progress_chart()})},init_course_progress_chart:function(){c(document.body).on("click",".progress-icon",function(e){e.preventDefault(),e.stopPropagation();var t,i,s,a,e=c(this).closest(".completed-component");e.length&&((t=e.find(".course-progress-popover")).length?(t.remove(),c(document).off("click.mto_outside keydown.mto_esc")):(c(".course-progress-popover").remove(),c(document).off("click.mto_outside keydown.mto_esc"),t=c(this).children(".masteriyo-summary-data").attr("data-summary"),i=t?JSON.parse(t):{},e.find(".course-progress-popover").remove(),s=c('<div class="course-progress-popover" />').appendTo(e),a="",Object.keys(i).forEach(function(e){var t,s,o,r;"total"!==e&&(t=i[e]||{},0<Number(t.total))&&(a+=(e=e,t=t,s=Number(t.total),o=Number(t.completed),t=Number(t.pending),(!Number.isFinite(s)||s<0)&&(s=0),(!Number.isFinite(o)||o<0)&&(o=0),(!Number.isFinite(t)||t<0)&&(t=Math.max(s-o,0)),s=0<s?o/s*100:0,e=String(e).toUpperCase(),'<div class="row"><div class="masteriyo-course-progress-stats"><svg class="masteriyo-course-progress-ring" viewBox="0 0 200 200"><circle class="masteriyo-course-progress-ring__background" cx="100" cy="100" r="90"></circle><circle class="masteriyo-course-progress-ring__progress" cx="100" cy="100" r="90" style="stroke-dasharray: '+(r=2*Math.PI*90)+"; stroke-dashoffset:"+(r-s/100*r)+';"></circle></svg><div class="validity-countdown"><span class="validity-countdown--number">'+Math.round(s)+'%</span></div></div><div class="course-progress-text"><div class="label">'+e+'</div><div class="progress-details"><div class="progress-completed">'+o+' Completed</div><div class="progress-left">'+t+" Left</div></div></div></div>"))}),a?(s.html(a).addClass("visible"),s.off("click.mto_popstop").on("click.mto_popstop",function(e){e.stopPropagation()}),c(document).off("click.mto_outside").on("click.mto_outside",function(e){c(e.target).closest(".course-progress-popover, .progress-icon").length||(s.remove(),c(document).off("click.mto_outside keydown.mto_esc"))}),c(document).off("keydown.mto_esc").on("keydown.mto_esc",function(e){"Escape"===e.key&&(s.remove(),c(document).off("click.mto_outside keydown.mto_esc"))})):s.remove()))})},toggle_masteriyo_instructor:function(){c(document).on("click",".additional-masteriyo-instructors-more",function(e){e.preventDefault();var t=c(this),e=t.attr("aria-controls"),s=c("#"+e);s.length&&(e="true"===t.attr("aria-expanded"),t.attr("aria-expanded",String(!e)),e?s.attr("hidden","hidden"):(s.removeAttr("hidden"),s.find("a").filter(function(){return""===c.trim(c(this).text())&&0===c(this).children().length}).remove()),c(document).off("keydown.mto_esc").on("keydown.mto_esc",function(e){"Escape"===e.key&&s.attr("hidden","hidden")}),c(document).off("click.mto_outside").on("click.mto_outside",function(e){s.is(e.target)||0!==s.has(e.target).length||t.is(e.target)||0!==t.has(e.target).length||(s.attr("hidden","hidden"),t.attr("aria-expanded","false"),c(document).off("click.mto_outside"))}))})},init_course_search:function(){c(document.body).on("submit","form.masteriyo-course-search",function(e){e.preventDefault(),r.currentPage=0,r.refreshCourses()})},init_course_filters:function(){c(document.body).on("click",".masteriyo-toggle-course-filters-sidebar",function(){e.toggleFiltersSidebar()}),c(document.body).on("click",".masteriyo-close-filters-sidebar, .masteriyo-course-filter-sidebar-overlay",function(){e.closeFiltersSidebar()}),c(window).on("resize",function(){c(this).height()<=768&&e.closeFiltersSidebar()}),c(document.body).on("input",".masteriyo-price-from-filter, .masteriyo-price-to-filter",function(){let e;return function(){clearTimeout(e),e=setTimeout(function(){r.currentPage=0,r.refreshCourses()},500)}}()),c(document.body).on("change",".range-min, .range-max",function(){r.currentPage=0,r.refreshCourses()}),c(document.body).on("change",'.masteriyo-courses-filters select, .masteriyo-courses-filters input[type="checkbox"],.masteriyo-courses-filters input[type="radio"]',function(){r.currentPage=0,r.refreshCourses()}),c(document.body).on("click",".masteriyo-clear-filters",function(e){e.preventDefault(),r.currentPage=0,c(".masteriyo-rating-filter-link").removeClass("active"),c(".search-field.masteriyo-input").val(""),c('.masteriyo-courses-filters select[name="price-type"]').val("");var e=c(".range-min").attr("min")||0,t=c(".range-max").attr("max")||100,s=c('.masteriyo-courses-filters input[name="price-from"]'),o=c('.masteriyo-courses-filters input[name="price-to"]');s.val(e).trigger("input").trigger("change"),o.val(t).trigger("input").trigger("change"),c(".masteriyo-price-progress").removeAttr("style"),c('.masteriyo-courses-filters input[name="categories[]"], .masteriyo-courses-filters input[name="difficulties[]"], .masteriyo-courses-filters input[name="rating[]"], .masteriyo-courses-filters input[name="price-type"]').prop("checked",!1),c(document.body).trigger("masteriyo_clear_course_filters"),r.refreshCourses()}),c(document.body).on("click",".masteriyo-see-more-categories",function(e){e.preventDefault(),c(this).addClass("masteriyo-hidden"),c(".masteriyo-overflowed-category").removeClass("masteriyo-hidden"),c(".masteriyo-see-less-categories").removeClass("masteriyo-hidden")}),c(document.body).on("click",".masteriyo-see-less-categories",function(e){e.preventDefault(),c(this).addClass("masteriyo-hidden"),c(".masteriyo-overflowed-category").addClass("masteriyo-hidden"),c(".masteriyo-see-more-categories").removeClass("masteriyo-hidden")})},init_course_sorting:function(){c(document.body).on("change","select.masteriyo-courses-order-by",function(){var e=c(this).find("option:selected").data("order");c("input.masteriyo-courses-sorting-order").val(e),r.currentPage=0,r.refreshCourses()})},toggleFiltersSidebar:function(){c(".masteriyo-filter-section--heading").on("click",function(){var e=c(this).closest(".masteriyo-filter-section"),t=e.find(".masteriyo-filter-wrapper"),s=e.find(".toggle-arrow"),o=e.find(".masteriyo-see-more-categories"),r=e.find(".masteriyo-see-less-categories");t.slideToggle(200),s.toggleClass("rotated"),s.hasClass("rotated")?(o.slideUp(200),r.slideUp(200)):(t=e.find(".masteriyo-overflowed-category.masteriyo-hidden"),s=e.find(".masteriyo-overflowed-category:not(.masteriyo-hidden)"),0<t.length?(o.slideDown(200),r.hide()):0<s.length&&(o.hide(),r.slideDown(200)))}),c(".masteriyo-see-more-categories").on("click",function(e){e.preventDefault();var e=c(this).closest(".masteriyo-filter-section"),t=e.find(".masteriyo-overflowed-category"),s=c(this),e=e.find(".masteriyo-see-less-categories");t.removeClass("masteriyo-hidden"),s.hide(),e.show()}),c(".masteriyo-see-less-categories").on("click",function(e){e.preventDefault();var e=c(this).closest(".masteriyo-filter-section"),t=e.find(".masteriyo-overflowed-category"),e=e.find(".masteriyo-see-more-categories"),s=c(this);t.addClass("masteriyo-hidden"),e.show(),s.hide()})},init_price_slider:function(){let o=c(".masteriyo-price-range-input input"),r=c(".masteriyo-price-filter--input input"),i=c(".masteriyo-price-progress"),a=parseFloat(o.eq(1).attr("max")),n=Math.max(1,Math.floor(.05*a));r.on("input",function(e){var t=parseFloat(r.eq(0).val()),s=parseFloat(r.eq(1).val());s-t>=n&&s<=a&&(c(e.target).hasClass("masteriyo-price-from-filter")?(o.eq(0).val(t),i.css("left",t/a*100+"%")):(o.eq(1).val(s),i.css("right",100-s/a*100+"%")))}),o.on("input",function(e){let t=parseFloat(o.eq(0).val()),s=parseFloat(o.eq(1).val());s-t<n&&(c(e.target).hasClass("range-min")?(o.eq(0).val(s-n),t=s-n):(o.eq(1).val(t+n),s=t+n)),r.eq(0).val(t),r.eq(1).val(s),i.css("left",t/a*100+"%"),i.css("right",100-s/a*100+"%")})}};n.init(),o.init()}(jQuery,window.masteriyo_data);